<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ETISS 0.8.0: How to create a sub project for ETISS</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ETISS 0.8.0
   </div>
   <div id="projectbrief">ExtendableTranslatingInstructionSetSimulator(version0.8.0)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">How to create a sub project for ETISS </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This tutorial is intended for the creation of a plugin for ETISS (<a class="el" href="classetiss_1_1CPUArch.html" title="the interface to translate instructions of and processor architecture">etiss::CPUArch</a>,<a class="el" href="classetiss_1_1JIT.html" title="compiler interface for just in time compilation of generated C code">etiss::JIT</a>,<a class="el" href="classetiss_1_1Plugin.html" title="base plugin class that provides access to different plugin functions if present">etiss::Plugin</a>). Refer to <a class="el" href="howto_etiss.html">this</a> page for information about how to use ETISS in a simulation.</p>
<p>ETISS plugins can be put into 4 folders. <a class="el" href="classetiss_1_1CPUArch.html" title="the interface to translate instructions of and processor architecture">etiss::CPUArch</a>,<a class="el" href="classetiss_1_1JIT.html" title="compiler interface for just in time compilation of generated C code">etiss::JIT</a> and <a class="el" href="classetiss_1_1Plugin.html" title="base plugin class that provides access to different plugin functions if present">etiss::Plugin</a> implementtions should be put into ArchImpl,JITImple and PluginImpl respectively and general projects that don't fit into that category can be put into the projects folder.</p>
<p>CMake is used to build ETISS and sub projects. By default the CMakeLists.txt files will scan the ArchImpl,JITImple,PluginImpl and projects folders for subfolders and will add those folders to the current build if they contain a CMakeLists.txt file. If you are familiar with CMake then the next section can be skipped.</p>
<h1><a class="anchor" id="howto_createproject_tmpl"></a>
ETISS's CMakeLists.txt.template</h1>
<p>To speed up sub project creation a CMakeLists.txt helper file is provided. With that file and these step by step instructions it is possible to compile C++ code without knowing cmake. Furthermore the template file allows to use a Makefile instead of cmake. For instructions to use a Makefile see <a class="el" href="howto_createproject.html#howto_createproject_tmpl_make">Using a Makefile</a>.</p>
<h2><a class="anchor" id="howto_createproject_tmpl_step1"></a>
Step 1:</h2>
<p>Create a project folder in the ArchImpl,JITImple,PluginImpl or projects folder (e.g. ArchImpl/OR1K).</p>
<h2><a class="anchor" id="howto_createproject_tmpl_step2"></a>
Step 2:</h2>
<p>In the project folde create a CMakeLists.txt file (e.g. <a class="el" href="ArchImpl_2OR1K_2CMakeLists_8txt.html">ArchImpl/OR1K/CMakeLists.txt</a>). Copy the following text into the created file and replace the YOURPROJECT% token with the name of your project (e.g. <a class="el" href="classOR1KArch.html" title="TODO: implement opt_hostendianess for store/load instructions.">OR1KArch</a>)</p>
<div class="fragment"><div class="line"><a class="code" href="JITImpl_2TCC_2CMakeLists_8txt.html#afec2f53c8d2d6bfd3d0c2a7fefc6bd06">set</a>(ETISS_PROJECT_NAME %YOURPROJECT% )</div>
<div class="line"><a class="code" href="JITImpl_2TCC_2CMakeLists_8txt.html#afec2f53c8d2d6bfd3d0c2a7fefc6bd06">set</a>(ETISS_PROJECT_PATH ${CMAKE_CURRENT_LIST_DIR})</div>
<div class="line"> </div>
<div class="line">include(../../CMakeLists.txt.project.template)</div>
</div><!-- fragment --><h2><a class="anchor" id="howto_createproject_tmpl_step3"></a>
Step 3:</h2>
<p>If all source files (*.ccp) are located in your project directory (e.g. ArchImpl/OR1K/*.cpp) and project header files are located in your project directory or a subfolder called include within your project directory then no further actions are required an the project was successfully created. In that case you can skip to <a class="el" href="howto_createproject.html#howto_createproject_tmpl_step4">Step 4</a>. Otherwise it is neccessary to add source/header files to the project manually.</p>
<p>Source files can be added to the "${ETISS_PROJECT_NAME}_ADDITIONAL_PROJECT_FILES" variable. The command file(GLOB_RECURSE ${ETISS_PROJECT_NAME}_ADDITIONAL_PROJECT_FILES src/*.cpp) can be used for example to add any *.cpp file in the src sub folder.</p>
<p>To include header paths simply add the line include_directories("/path/to/header/directory").</p>
<p>Example: </p><div class="fragment"><div class="line"><a class="code" href="JITImpl_2TCC_2CMakeLists_8txt.html#afec2f53c8d2d6bfd3d0c2a7fefc6bd06">set</a>(ETISS_PROJECT_NAME %YOURPROJECT% )</div>
<div class="line"><a class="code" href="JITImpl_2TCC_2CMakeLists_8txt.html#afec2f53c8d2d6bfd3d0c2a7fefc6bd06">set</a>(ETISS_PROJECT_PATH ${CMAKE_CURRENT_LIST_DIR})</div>
<div class="line"> </div>
<div class="line">file(GLOB_RECURSE ${ETISS_PROJECT_NAME}_ADDITIONAL_PROJECT_FILES src<span class="comment">/*.cpp) # add all *.cpp in the src folder and its sub folders</span></div>
<div class="line"><span class="comment">set(${ETISS_PROJECT_NAME}_ADDITIONAL_PROJECT_FILES ${${ETISS_PROJECT_NAME}_ADDITIONAL_PROJECT_FILES} /some/additional/source/file.cpp) # adds the &quot;/some/additional/source/file.cpp&quot; file to the list of source files</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">include_directories(&quot;/path/to/header/directory&quot;) # add a custom header search path</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">include(../../CMakeLists.txt.project.template)</span></div>
</div><!-- fragment --><h2><a class="anchor" id="howto_createproject_tmpl_step4"></a>
Step 4:</h2>
<p>If there is already a build directoy where the command "$cmake /path/to/ETISS" has been executed in, then it is neccessary to clean that directory and run the command again.</p>
<p>Otherwise simply create a build directory (e.g. path/to/ETISS/install). <br  />
In a console window run: </p><div class="fragment"><div class="line">$cd path/to/ETISS/install</div>
<div class="line">$cmake path/to/ETISS</div>
</div><!-- fragment --><dl class="section attention"><dt>Attention</dt><dd>due to some legacy Makefiles that are used it is strongly recommended to not use a directoy called build within the ETISS project folder (e.g. path/to/ETISS/build).</dd></dl>
<h2><a class="anchor" id="howto_createproject_tmpl_make"></a>
Using a Makefile</h2>
<p>To use a Makefile with your project follow <a class="el" href="howto_createproject.html#howto_createproject_tmpl_step1">Step 1</a> and Step 2. Then add the line set(${ETISS_PROJECT_NAME}_MAKEFILE Makefile) to the CMakeLists.txt file. In case the makefile is not called Makefile that part need to be changed.</p>
<div class="fragment"><div class="line"><a class="code" href="JITImpl_2TCC_2CMakeLists_8txt.html#afec2f53c8d2d6bfd3d0c2a7fefc6bd06">set</a>(ETISS_PROJECT_NAME %YOURPROJECT%)</div>
<div class="line"><a class="code" href="JITImpl_2TCC_2CMakeLists_8txt.html#afec2f53c8d2d6bfd3d0c2a7fefc6bd06">set</a>(ETISS_PROJECT_PATH ${CMAKE_CURRENT_LIST_DIR})</div>
<div class="line"> </div>
<div class="line"><a class="code" href="JITImpl_2TCC_2CMakeLists_8txt.html#afec2f53c8d2d6bfd3d0c2a7fefc6bd06">set</a>(${ETISS_PROJECT_NAME}_MAKEFILE Makefile) #usually <span class="keyword">this</span> is right but <span class="keywordflow">if</span> your makefile has a special <a class="code" href="timesoftfloat_8c.html#a5ac083a645d964373f022d03df4849c8">name</a> then <span class="keyword">this</span> needs to be changed</div>
<div class="line"> </div>
<div class="line">include(../../CMakeLists.txt.project.template)</div>
</div><!-- fragment --><p>In this case it is expected that the sub project creates a shared library in its project folder named after of the project name and the platform dependent default library prefix and sufix strings (e.g project name is "test" then on linux a libtest.so file is expected).</p>
<p>The makefile will be executed with these 3 variables set: </p><table class="doxtable">
<tr>
<th>Variable </th><th>Description  </th></tr>
<tr>
<td>INCLUDE_ARGS </td><td>arguments that should be passed to compiler invections for files that include etiss headers.  </td></tr>
<tr>
<td>INCLUDE_DIRS </td><td>list of directories that contain header files needed for/by ETISS  </td></tr>
<tr>
<td>BUILD_DIR </td><td>a build directory where the makefile should put compilation results into  </td></tr>
</table>
<p>Project files should be added to the ${ETISS_PROJECT_NAME}_MAKEFILE_PROJECTFILES variable to show them in genereated IDE projects (e.g. set(${ETISS_PROJECT_NAME}_MAKEFILE_PROJECTFILES <a class="el" href="main_8cpp.html">main.cpp</a>). Files added to this variable will NOT be compiled/processed in any way by cmake. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<div class="ttc" id="atimesoftfloat_8c_html_a5ac083a645d964373f022d03df4849c8"><div class="ttname"><a href="timesoftfloat_8c.html#a5ac083a645d964373f022d03df4849c8">name</a></div><div class="ttdeci">char * name</div><div class="ttdef"><b>Definition:</b> <a href="timesoftfloat_8c_source.html#l01931">timesoftfloat.c:1931</a></div></div>
<div class="ttc" id="aJITImpl_2TCC_2CMakeLists_8txt_html_afec2f53c8d2d6bfd3d0c2a7fefc6bd06"><div class="ttname"><a href="JITImpl_2TCC_2CMakeLists_8txt.html#afec2f53c8d2d6bfd3d0c2a7fefc6bd06">set</a></div><div class="ttdeci">set(ETISS_TCC_SELINUX OFF CACHE BOOL &quot;Enable SELinux support in the TCC JIT engine&quot;) unset(TCCJIT_ARCH) if(UNIX) set(TCCJIT_ARCH unix) execute_process(COMMAND getenforce OUTPUT_VARIABLE ETISS_TCC_GETENFORCE_OUT OUTPUT_STRIP_TRAILING_WHITESPACE) if(ETISS_TCC_GETENFORCE_OUT STREQUAL &quot;Enforcing&quot;) set(ETISS_TCC_SELINUX ON) endif() elseif(WIN32) if(CMAKE_SIZEOF_VOID_P EQUAL 8) set(TCCJIT_ARCH win64) else() set(TCCJIT_ARCH win32) endif() else() message(ERROR &quot;cannot build TCCJIT on this unknown system&quot;) endif() set(ETISS_TCC_CONFIGURE_ARGS &quot;&quot;) if(ETISS_TCC_SELINUX) set(ETISS_TCC_CONFIGURE_ARGS $</div><div class="ttdef"><b>Definition:</b> <a href="JITImpl_2TCC_2CMakeLists_8txt_source.html#l00039">CMakeLists.txt:39</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Aug 19 2022 12:53:22 for ETISS 0.8.0 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
