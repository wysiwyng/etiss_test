<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ETISS 0.8.0: How to implement a cpu architecture for ETISS</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ETISS 0.8.0
   </div>
   <div id="projectbrief">ExtendableTranslatingInstructionSetSimulator(version0.8.0)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">How to implement a cpu architecture for ETISS </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>ETISS includes an example implementation of the <a class="el" href="structOR1K.html">OR1K</a> cpu architecture. It is located in ArchImpl/OR1K/ and should be refered to for examples.</p>
<p>For simplification the architecture in this guide will be referred to as <b>X</b>.</p>
<h1><a class="anchor" id="howto_cpuarch_step1"></a>
Step 1: Create a workfolder and necessary files</h1>
<p>First of all a directory for your cpu architecture should be created. It is recommended to create a folder in ArchImpl with the name of the cpu architecture (analogue to ArchImpl/OR1K/: ArchImpl/<b>X</b>/)</p>
<p>For the following steps a header file for the cpu state structure, a header and source file for the <a class="el" href="classetiss_1_1CPUArch.html" title="the interface to translate instructions of and processor architecture">etiss::CPUArch</a> implementation and a source file containing an interface for etiss are needed. The following empty files should be created in your ArchImpl/<b>X</b>/ folder:</p>
<pre>
		<b>X</b>.h
		<b>X</b>Arch.h
		<b>X</b>Arch.cpp
		<b>X</b>ArchLib.cpp
		CMakeLists.txt
	</pre><p>For a how-to for the creation of a CMakeLists.txt file please have a look at <a class="el" href="howto_createproject.html">How to create a sub project for ETISS</a></p>
<h1><a class="anchor" id="howto_cpuarch_step2"></a>
Step 2: Implement a CPU state structure</h1>
<p>ETISS requires the state of a cpu to be stored in a structure. The basic CPU structure defined as <a class="el" href="structETISS__CPU.html" title="basic cpu state structure needed for execution of any cpu architecture.">ETISS_CPU</a> in <a class="el" href="etiss__test_2include__c_2etiss_2jit_2CPU_8h.html" title="contains the basic cpu state structure with a instruction pointer and time parameters....">include_c/etiss/jit/CPU.h</a> contains fields for cpu time, instruction pointer and cycle time. This structure needs to be extended for a cpu architecture. The new structure should be defined in <b>X</b>.h .</p>
<p><b> NOTE: the code in X.h must be C compliant code (not just C++) since it needs to be used at runtime for just in time code compilation. </b></p>
<p>The content of <b>X</b>.h should look like this:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#ifndef X_X_H_</span></div>
<div class="line"><span class="preprocessor">#define X_X_H_</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;etiss/jit/CPU.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef __cplusplus</span></div>
<div class="line"><span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> {</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#pragma pack(push, 1) // important!</span></div>
<div class="line"><span class="keyword">struct </span>X {</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="structETISS__CPU.html">ETISS_CPU</a> cpu; <span class="comment">// original cpu struct must be defined as the first field of the new structure. this allows to cast X * to ETISS_CPU * and vice versa</span></div>
<div class="line"> </div>
<div class="line">        <a class="code" href="build_2include_2jit_2etiss_2jit_2types_8h.html#a72b9abbce981da044b8fce9af82f1d66">etiss_uint32</a> X_registers[16]; <span class="comment">// some example registers</span></div>
<div class="line"> </div>
<div class="line">        <a class="code" href="build_2include_2jit_2etiss_2jit_2types_8h.html#a72b9abbce981da044b8fce9af82f1d66">etiss_uint32</a> X_intterrupt; <span class="comment">// some interrupt register</span></div>
<div class="line"> </div>
<div class="line">        <a class="code" href="build_2include_2jit_2etiss_2jit_2types_8h.html#a72b9abbce981da044b8fce9af82f1d66">etiss_uint32</a> X_intterrupt_mask; <span class="comment">// some interrupt mask</span></div>
<div class="line"> </div>
<div class="line">        <a class="code" href="build_2include_2jit_2etiss_2jit_2types_8h.html#a72b9abbce981da044b8fce9af82f1d66">etiss_uint32</a> timercfg; <span class="comment">// some timer configuration register</span></div>
<div class="line"> </div>
<div class="line">        <span class="comment">// further registers</span></div>
<div class="line"> </div>
<div class="line">};</div>
<div class="line"><span class="preprocessor">#pragma pack(pop) // undo changes</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>X X; <span class="comment">// convenient use of X instead of struct X in generated C code</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef __cplusplus</span></div>
<div class="line">} <span class="comment">// extern &quot;C&quot;</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#endif</span></div>
</div><!-- fragment --><p>Additionally it is neccessary to support a VirtualStruct to allow access to the fields by various plugins. Please have a look at the documentation of <a class="el" href="classetiss_1_1VirtualStruct.html" title="abstract representation of an module of a simulation which could be a embedded device of the cpu of a...">etiss::VirtualStruct</a> and <a class="el" href="classetiss_1_1VirtualStruct_1_1Field.html" title="a Field instance represents e.g.">etiss::VirtualStruct::Field</a>. This needs to be implemented by the <a class="el" href="classetiss_1_1CPUArch.html" title="the interface to translate instructions of and processor architecture">etiss::CPUArch</a> object.</p>
<h1><a class="anchor" id="howto_cpuarch_step3"></a>
Step3 : Implement etiss::CPUArch</h1>
<p>To enable ETISS to execute instructions of a cpu architecture, <a class="el" href="classetiss_1_1CPUArch.html" title="the interface to translate instructions of and processor architecture">etiss::CPUArch</a> needs to be implemented to handle translation of instructions to C code and to provide basic architecture related information and functions.</p>
<p>The implementation should be done in <b>X</b>Arch.h/.cpp.</p>
<p><b>X</b>Arch.h:</p>
<div class="fragment"><div class="line"><span class="preprocessor">    #include &quot;<a class="code" href="CPUArch_8h.html">etiss/CPUArch.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">    #include &quot;X.h&quot;</span></div>
<div class="line"><span class="preprocessor">    #include &quot;XTimer.h&quot;</span> <span class="comment">// optional</span></div>
<div class="line"><span class="preprocessor">    #include &quot;XGDBCore.h&quot;</span> <span class="comment">// optional</span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">class </span>XArch : <span class="keyword">public</span> <a class="code" href="classetiss_1_1CPUArch.html">etiss::CPUArch</a> {</div>
<div class="line">    <span class="keyword">public</span>:</div>
<div class="line">        XArch();</div>
<div class="line">        ~XArch();</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">const</span> std::set&lt;std::string&gt; &amp; <a class="code" href="classetiss_1_1CPUArchRegListenerInterface.html#a27b3f3b61ee0e1e70e291c73132c1efd">getListenerSupportedRegisters</a>(); <span class="comment">// defined by etiss::CPUArchRegListenerInterface</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// provide flexible access to the field of your cpu state structure</span></div>
<div class="line">        <span class="keyword">virtual</span> std::shared_ptr&lt;etiss::VirtualStruct&gt; <a class="code" href="classetiss_1_1CPUArchCPUManipulation.html#a5062b8521e7c9fd4e0f6865a2fc02828">getVirtualStruct</a>(<a class="code" href="structETISS__CPU.html">ETISS_CPU</a> * cpu);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// optional but common functions to provide a timer for the cpu architecture</span></div>
<div class="line">        <a class="code" href="classetiss_1_1Plugin.html">etiss::Plugin</a> * <a class="code" href="classetiss_1_1CPUArchDefaultPlugins.html#a18f03e3f9c5003f5079fc86d1169828e">newTimer</a>(<a class="code" href="structETISS__CPU.html">ETISS_CPU</a> * cpu);  <span class="comment">// see How to implement a cpu architecture for ETISS: Step 4 // defined by etiss::CPUArchDefaultPlugins</span></div>
<div class="line">        <span class="keywordtype">void</span> <a class="code" href="classetiss_1_1CPUArchDefaultPlugins.html#abcafc22a438cb8434876cdd9b757667c">deleteTimer</a>(<a class="code" href="classetiss_1_1Plugin.html">etiss::Plugin</a> * timer);  <span class="comment">// defined by etiss::CPUArchDefaultPlugins</span></div>
<div class="line"> </div>
<div class="line">        <a class="code" href="structETISS__CPU.html">ETISS_CPU</a> * <a class="code" href="classetiss_1_1CPUArch.html#aef31da82cfd8db497138468a07879909">newCPU</a>(); <span class="comment">// allocate a X structure</span></div>
<div class="line">        <span class="keywordtype">void</span> <a class="code" href="classetiss_1_1CPUArch.html#a168a3a295931bc7df7a47994c492b6c8">resetCPU</a>(<a class="code" href="structETISS__CPU.html">ETISS_CPU</a> * cpu,<a class="code" href="386-GCC_8h.html#afaa37edb86065f42a0ad0a0f6c13aac2">etiss::uint64</a> * startpointer); <span class="comment">// reset registers and instruction pointer</span></div>
<div class="line">        <span class="keywordtype">void</span> <a class="code" href="classetiss_1_1CPUArch.html#a09227a06379d2f2a91da6f10faa9131a">deleteCPU</a>(<a class="code" href="structETISS__CPU.html">ETISS_CPU</a> *); <span class="comment">// delete previously allocated X structure</span></div>
<div class="line">        <span class="keywordtype">unsigned</span> <a class="code" href="classetiss_1_1CPUArch.html#ad07535d7ce770c9bf1444ba652019138">getMaximumInstructionSizeInBytes</a>(); <span class="comment">// largest block of data containing instruction(s) that may be requested by the translate function (e.g. 8 byte for 32bit instructions where a delay slot instruction needs to be translated together with the previous instruction (=2 instructions))</span></div>
<div class="line">        <span class="keywordtype">unsigned</span> <a class="code" href="classetiss_1_1CPUArch.html#a78b44720cd799cf5bc3ab664a4510140">getInstructionSizeInBytes</a>(); <span class="comment">// smalest number of bytes of on instruction (e.g. 4 byte for 32bit instructions)</span></div>
<div class="line">        <span class="keyword">const</span> std::set&lt;std::string&gt; &amp; <a class="code" href="classetiss_1_1CPUArch.html#a3b3421671e0809efe8d3b63ece28fc52">getHeaders</a>() <span class="keyword">const</span>; <span class="comment">// should return e.g. &quot;X.h&quot; and (if the cpu uses ETISS&#39;s integrated softfloat functions) &quot;etiss/jit/fpu/softfloat.h&quot;</span></div>
<div class="line">        <span class="comment">// optional but common function to handle cpu execution related exceptions. if not implemented any exception will terminate the simulated cpu</span></div>
<div class="line">        <a class="code" href="386-GCC_8h.html#a414f0173400e449eed05f3d8cc6e72e0">etiss::int32</a> <a class="code" href="classetiss_1_1CPUArch.html#af7f949bf98cf21778e678ce64c7d16a7">handleException</a>(<a class="code" href="386-GCC_8h.html#a414f0173400e449eed05f3d8cc6e72e0">etiss::int32</a> code,<a class="code" href="structETISS__CPU.html">ETISS_CPU</a> * cpu); <span class="comment">// applies exceptions to the cpu state and returns 0 on success</span></div>
<div class="line">        <span class="comment">// optional but common function to provide access to the interrupt vector of a cpu</span></div>
<div class="line">        <a class="code" href="classetiss_1_1InterruptVector.html">etiss::InterruptVector</a> * <a class="code" href="classetiss_1_1CPUArch.html#a8a21733db333251915508f937b2fabf5">createInterruptVector</a>(<a class="code" href="structETISS__CPU.html">ETISS_CPU</a> * cpu);</div>
<div class="line">        <span class="keywordtype">void</span> <a class="code" href="classetiss_1_1CPUArch.html#a818102cdbe32c2e1aef2501170231254">deleteInterruptVector</a>(<a class="code" href="classetiss_1_1InterruptVector.html">etiss::InterruptVector</a> * vec,<a class="code" href="structETISS__CPU.html">ETISS_CPU</a> * cpu);</div>
<div class="line">        <span class="comment">// optional but common function to support a gdb server</span></div>
<div class="line">        <a class="code" href="classetiss_1_1plugin_1_1gdb_1_1GDBCore.html">etiss::plugin::gdb::GDBCore</a> &amp; <a class="code" href="classetiss_1_1CPUArch.html#a73e73070b3ea20e320166eca643bd295">getGDBCore</a>(); <span class="comment">// see How to implement a cpu architecture for ETISS: Step 5</span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">private</span>:</div>
<div class="line">        std::set&lt;std::string&gt; listenerSupportedRegisters_; <span class="comment">// used by const std::set&lt;std::string&gt; &amp; getListenerSupportedRegisters()</span></div>
<div class="line">        std::set&lt;std::string&gt; registers32_; <span class="comment">// used by const std::set&lt;std::string&gt; &amp; getRegisters32()</span></div>
<div class="line">        std::set&lt;std::string&gt; headers_; <span class="comment">// used by const std::set&lt;std::string&gt; &amp; getHeaders() const</span></div>
<div class="line">        XGDBCore xgdbcore_; <span class="comment">// used by etiss::plugin::gdb::GDBCore &amp; getGDBCore() /// see How to implement a cpu architecture for ETISS: Step 5</span></div>
<div class="line">    };</div>
</div><!-- fragment --><p><b>X</b>Arch.cpp:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;XArch.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceetiss.html">etiss</a>;</div>
<div class="line"> </div>
<div class="line">XArch::XArch() : <a class="code" href="classetiss_1_1CPUArch.html">CPUArch</a>(<span class="stringliteral">&quot;X&quot;</span>){</div>
<div class="line">        <span class="comment">//TODO</span></div>
<div class="line"> </div>
<div class="line">        registers32_.insert(<span class="stringliteral">&quot;timerConfig&quot;</span>);</div>
<div class="line">        registers32_.insert(<span class="stringliteral">&quot;X_registers1&quot;</span>); <span class="comment">// X::X_registers[1]</span></div>
<div class="line">        <span class="comment">// add other registers</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">        headers_.insert(<span class="stringliteral">&quot;X.h&quot;</span>);</div>
<div class="line">        headers_.insert(<span class="stringliteral">&quot;etiss/jit/fpu/softfloat.h&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        listenerSupportedRegisters_.insert(<span class="stringliteral">&quot;timerConfig&quot;</span>); <span class="comment">// for X::timercfg</span></div>
<div class="line"> </div>
<div class="line">}</div>
<div class="line">XArch::~XArch() {</div>
<div class="line">        <span class="comment">//TODO</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">const</span> std::set&lt;std::string&gt; &amp; XArch::getListenerSupportedRegisters(){</div>
<div class="line">        <span class="keywordflow">return</span> listenerSupportedRegisters_;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">std::shared_ptr&lt;etiss::VirtualStruct&gt; getVirtualStruct(<a class="code" href="structETISS__CPU.html">ETISS_CPU</a> * cpu){</div>
<div class="line">    <span class="keyword">auto</span> ret = <span class="keyword">new</span> <a class="code" href="classetiss_1_1VirtualStruct.html">etiss::VirtualStruct</a>(cpu,[](Field*f){<span class="keyword">delete</span> f;});</div>
<div class="line">    </div>
<div class="line">    X * xcpu = (X*)cpu;</div>
<div class="line">    </div>
<div class="line">    ret-&gt;<a class="code" href="classetiss_1_1VirtualStruct.html#a81c8fe4e603c8ab1a08e73c06e2266f5">addField</a>(<span class="keyword">new</span> <a class="code" href="classetiss_1_1VirtualStruct_1_1Field.html">etiss::VirtualStruct::Field</a>(</div>
<div class="line">*ret, <span class="comment">// reference to the parent structure</span></div>
<div class="line">std::string(<span class="stringliteral">&quot;X_registers[12]&quot;</span>), <span class="comment">// name</span></div>
<div class="line">std::string(<span class="stringliteral">&quot;X_register_12&quot;</span>), <span class="comment">// pretty (human readable) name</span></div>
<div class="line"><a class="code" href="classetiss_1_1VirtualStruct_1_1Field.html#ac49114585e171aaa911f0c9c5670cafb">etiss::VirtualStruct::Field::R</a>|<a class="code" href="classetiss_1_1VirtualStruct_1_1Field.html#a0c09eb9065c5126f9e16b5e86f5c24fe">etiss::VirtualStruct::Field::W</a>, <span class="comment">// read/write flags</span></div>
<div class="line">4, <span class="comment">// width in bytes</span></div>
<div class="line"><span class="keyword">false</span>, <span class="comment">// use provided lambda function and not virtual functions</span></div>
<div class="line">[ret](){ <span class="comment">// read</span></div>
<div class="line">                        <span class="keywordflow">return</span> (<a class="code" href="tcc__stdlib_2stddef_8h.html#ab03496aa717fb9c7bee01384c245dd05">uint64_t</a>) ((X*)ret-&gt;structure_)-&gt;X_registers[12];</div>
<div class="line">                },</div>
<div class="line">                [vcore,i](<a class="code" href="tcc__stdlib_2stddef_8h.html#ab03496aa717fb9c7bee01384c245dd05">uint64_t</a> val){ <span class="comment">// write</span></div>
<div class="line">                        ((X*)ret-&gt;structure_)-&gt;X_registers[12] = (<a class="code" href="tcc__stdlib_2stddef_8h.html#a1be1f6f1e6c132e4c0a037ee1edd6d83">uint32_t</a>)val;</div>
<div class="line">                }</div>
<div class="line">                );</div>
<div class="line">    </div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> ret;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><a class="code" href="classetiss_1_1Plugin.html">etiss::Plugin</a> * XArch::newTimer(<a class="code" href="structETISS__CPU.html">ETISS_CPU</a> * cpu){</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">new</span> XTimer(); <span class="comment">// see How to implement a cpu architecture for ETISS: Step 4</span></div>
<div class="line">}</div>
<div class="line"><span class="keywordtype">void</span> XArch::deleteTimer(<a class="code" href="classetiss_1_1Plugin.html">etiss::Plugin</a> * timer){</div>
<div class="line">        <span class="keyword">delete</span> timer;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="structETISS__CPU.html">ETISS_CPU</a> * XArch::newCPU(){</div>
<div class="line">        <span class="keywordflow">return</span> (<a class="code" href="structETISS__CPU.html">ETISS_CPU</a>*) <span class="keyword">new</span> X(); <span class="comment">// see How to implement a cpu architecture for ETISS: Step 2</span></div>
<div class="line">}</div>
<div class="line"><span class="keywordtype">void</span> XArch::resetCPU(<a class="code" href="structETISS__CPU.html">ETISS_CPU</a> * cpu,<a class="code" href="386-GCC_8h.html#afaa37edb86065f42a0ad0a0f6c13aac2">etiss::uint64</a> * startpointer){</div>
<div class="line">        <span class="comment">//TODO</span></div>
<div class="line">        <span class="comment">//e.g.</span></div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (startpointer)</div>
<div class="line">                cpu-&gt;<a class="code" href="structETISS__CPU.html#a06bc8709b023cbe50c7c594741fd47b4">instructionPointer</a> = *startpointer;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0;i&lt;16;i++)</div>
<div class="line">                ((X*)cpu)-&gt;X_registers[i] = 0;</div>
<div class="line"> </div>
<div class="line">        ((X*)cpu)-&gt;timercfg = 0x43847594;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">}</div>
<div class="line"><span class="keywordtype">void</span> XArch::deleteCPU(<a class="code" href="structETISS__CPU.html">ETISS_CPU</a> * cpu){</div>
<div class="line">        <span class="keyword">delete</span> cpu;</div>
<div class="line">}</div>
<div class="line"><span class="keywordtype">unsigned</span> XArch::getMaximumInstructionSizeInBytes(){</div>
<div class="line">        <span class="comment">//TODO</span></div>
<div class="line">        <span class="keywordflow">return</span> 8;</div>
<div class="line">}</div>
<div class="line"><span class="keywordtype">unsigned</span> XArch::getInstructionSizeInBytes(){</div>
<div class="line">        <span class="comment">//TODO</span></div>
<div class="line">        <span class="keywordflow">return</span> 4;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">const</span> std::set&lt;std::string&gt; &amp; XArch::getHeaders()<span class="keyword"> const</span>{</div>
<div class="line">        <span class="keywordflow">return</span> headers_;</div>
<div class="line">}</div>
<div class="line"><a class="code" href="386-GCC_8h.html#a414f0173400e449eed05f3d8cc6e72e0">etiss::int32</a> XArch::handleException(<a class="code" href="386-GCC_8h.html#a414f0173400e449eed05f3d8cc6e72e0">etiss::int32</a> code,<a class="code" href="structETISS__CPU.html">ETISS_CPU</a> * cpu){</div>
<div class="line">        <span class="comment">//TODO</span></div>
<div class="line">        <span class="comment">//e.g.</span></div>
<div class="line">        <span class="keywordflow">switch</span> (code){</div>
<div class="line">        <span class="keywordflow">case</span> etiss::RETURNCODE::DBUS_READ_ERROR: <span class="comment">// global data bus error code defined in include_c/etiss/jit/ReturnCode.h. These codes are also available in C under the name ETISS_RETURNCODE_XXXXXXXXXXXX (e.g. ETISS_RETURNCODE_DBUS_READ_ERROR)</span></div>
<div class="line">                cpu-&gt;<a class="code" href="structETISS__CPU.html#a06bc8709b023cbe50c7c594741fd47b4">instructionPointer</a> = 0x1000 &gt;&gt; 2; <span class="comment">// jump to an assumed error handler at address 0x1000. since the instruction pointer points to an instruction index, the addess 0x1000 need to be divided by the instruction size returned by getInstructionSizeInBytes() (in this case 4 hence &quot;&gt;&gt; 2&quot;)</span></div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="namespaceetiss_1_1mm.html#ae97afcab1c0c335c4b41ed82524d2ba9">etiss::RETURNCODE::NOERROR</a>; <span class="comment">// == 0 // return no error code since the error has been handled and should not terminate the simulation.</span></div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">                <span class="keywordflow">return</span> code; <span class="comment">// terminates cpu execution</span></div>
<div class="line">        }</div>
<div class="line">}</div>
<div class="line"><a class="code" href="classetiss_1_1InterruptVector.html">etiss::InterruptVector</a> * XArch::createInterruptVector(<a class="code" href="structETISS__CPU.html">ETISS_CPU</a> * cpu){</div>
<div class="line">        <span class="comment">//TODO</span></div>
<div class="line">        <span class="comment">//this may return a custom implementation of etiss::InterruptVector (in this case please refer to the documentation of that class)</span></div>
<div class="line">        <span class="comment">//a simpler solution is to use the template class etiss::MappedInterruptVector&lt;INT&gt; that allows to simply wrap pointers to integer variables as demonstrated by this code</span></div>
<div class="line">        <span class="comment">//e.g.</span></div>
<div class="line">        <a class="code" href="386-GCC_8h.html#a9ef56175e2c24dae60815d7eed003bdf">etiss::uint32</a> * interruptRegister = &amp;(((X*)cpu)-&gt;X_intterrupt); <span class="comment">// interrupt bit vector</span></div>
<div class="line">        <a class="code" href="386-GCC_8h.html#a9ef56175e2c24dae60815d7eed003bdf">etiss::uint32</a> * interruptMask = &amp;(((X*)cpu)-&gt;X_intterrupt_mask); <span class="comment">// mask for interrupt bits</span></div>
<div class="line"> </div>
<div class="line">        <span class="comment">//NOTE: MappedInterruptVector supports multiple consecutive interrupt + mask registers</span></div>
<div class="line">        std::vector&lt;etiss::uint32*&gt; interruptRegisters;</div>
<div class="line">        interruptRegisters.push_back(interruptRegister);</div>
<div class="line"> </div>
<div class="line">        std::vector&lt;etiss::uint32*&gt; interruptMasks;</div>
<div class="line">        interruptMasks.push_back(interruptMask);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classetiss_1_1MappedInterruptVector.html">MappedInterruptVector&lt;etiss::uint32&gt;</a>(interruptRegisters,interruptMasks);</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="line"><span class="keywordtype">void</span> XArch::deleteInterruptVector(<a class="code" href="classetiss_1_1InterruptVector.html">etiss::InterruptVector</a> * vec,<a class="code" href="structETISS__CPU.html">ETISS_CPU</a> * cpu){</div>
<div class="line">        <span class="keyword">delete</span> vec;</div>
<div class="line">}</div>
<div class="line"><a class="code" href="classetiss_1_1plugin_1_1gdb_1_1GDBCore.html">etiss::plugin::gdb::GDBCore</a> &amp; XArch::getGDBCore(){</div>
<div class="line">        <span class="keywordflow">return</span> xgdbcore_;</div>
<div class="line">}</div>
</div><!-- fragment --><p>If the above example has been modified to remove timer and gdbcore support then the next two chapters can be skipped.</p>
<p>Besides implmenting the CPUArch interface it is necessary to implement the inherited etiss::TranslatorPlugin interface. That interface is responsible for adding translation functionality. For further information please refer to the classes defined in <a class="el" href="Instruction_8h.html" title="contains container classes to store instruction definitions + translation functions and build a trans...">Instruction.h</a> . The classes <a class="el" href="classetiss_1_1instr_1_1ModedInstructionSet.html" title="holds etiss::instr::VariableInstructionSet instances for different modes.">etiss::instr::ModedInstructionSet</a>, <a class="el" href="classetiss_1_1instr_1_1VariableInstructionSet.html" title="holds etiss::instr::InstructionSet instances with different bit widths.">etiss::instr::VariableInstructionSet</a>, <a class="el" href="classetiss_1_1instr_1_1InstructionSet.html" title="holds etiss::instr::Instruction instances and handles automatic instruction tree creation.">etiss::instr::InstructionSet</a> and <a class="el" href="classetiss_1_1instr_1_1Instruction.html" title="holds information and translation callbacks for an instruction.">etiss::instr::Instruction</a> implement lookup and translation functionality. <a class="el" href="classetiss_1_1instr_1_1InstructionCollection.html" title="maps to ModedInstructionSet">etiss::instr::InstructionCollection</a>, <a class="el" href="classetiss_1_1instr_1_1InstructionClass.html" title="maps to VariableInstructionSet">etiss::instr::InstructionClass</a>, <a class="el" href="classetiss_1_1instr_1_1InstructionGroup.html" title="maps to InstructionSet">etiss::instr::InstructionGroup</a> and <a class="el" href="classetiss_1_1instr_1_1InstructionDefinition.html" title="maps to Instruction">etiss::instr::InstructionDefinition</a> are helper classes that allow to store neccessary information for the previous group of classes in an ordered manner. The <a class="el" href="structOR1K.html">OR1K</a> example uses those classes to define all instructions and uses the <a class="el" href="classetiss_1_1instr_1_1InstructionCollection.html#a9540933b96f577488e0a15ce43ebc09e">etiss::instr::InstructionCollection::addTo(ModedInstructionSet &amp;set, bool &amp;ok)</a> function to push the definitions into the ModedInstruction set and sub sets.</p>
<p>A simple example of an fictive instruction set implementation provided by a CPUArch using above classes:</p>
<div class="fragment"><div class="line">[...]</div>
<div class="line"> </div>
<div class="line"><a class="code" href="classetiss_1_1instr_1_1InstructionGroup.html">etiss::instr::InstructionGroup</a> Thumb16_all(<span class="stringliteral">&quot;Thumb16_all&quot;</span>,16);</div>
<div class="line"><a class="code" href="classetiss_1_1instr_1_1InstructionGroup.html">etiss::instr::InstructionGroup</a> ARMvX_all(<span class="stringliteral">&quot;ARMvX_all&quot;</span>,32);</div>
<div class="line"><a class="code" href="classetiss_1_1instr_1_1InstructionClass.html">etiss::instr::InstructionClass</a> Thumb16(1,<span class="stringliteral">&quot;Thumb16&quot;</span>,16,Thumb16_all);</div>
<div class="line"><a class="code" href="classetiss_1_1instr_1_1InstructionClass.html">etiss::instr::InstructionClass</a> ARMvX(0,<span class="stringliteral">&quot;ARMvX&quot;</span>,32,ARMv6_all);</div>
<div class="line"><a class="code" href="classetiss_1_1instr_1_1InstructionCollection.html">etiss::instr::InstructionCollection</a> CortexXX(<span class="stringliteral">&quot;CortexXX&quot;</span>,ARMvX,Thumb16);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> InstructionDefinition add(</div>
<div class="line">    ARMvX_all, <span class="comment">// associated InstructionGroup</span></div>
<div class="line"> </div>
<div class="line">    <span class="stringliteral">&quot;add&quot;</span>, <span class="comment">// name</span></div>
<div class="line"> </div>
<div class="line">    <a class="code" href="namespaceetiss_1_1instr.html#abd7ccc74d7b5d79f99f2febaf149f774">parse_i32</a>(<span class="stringliteral">&quot;6x38 15x0 1x0 2x0 4x0 4xe&quot;</span>), <span class="comment">// opcode value</span></div>
<div class="line"> </div>
<div class="line">    <a class="code" href="namespaceetiss_1_1instr.html#abd7ccc74d7b5d79f99f2febaf149f774">parse_i32</a>(<span class="stringliteral">&quot;6xFF 15x0 1x0 2xF 4x0 4xF&quot;</span>), <span class="comment">// mask that defines which bits make up the opcode</span></div>
<div class="line"> </div>
<div class="line">    [](BitArray &amp; ba,<a class="code" href="classetiss_1_1CodeSet.html">etiss::CodeSet</a> &amp; cs,InstructionContext &amp; ic) <span class="comment">// callback to translate the &quot;add&quot; instruction</span></div>
<div class="line">{</div>
<div class="line">    CodePart &amp; part = cs.<a class="code" href="classetiss_1_1CodeSet.html#a7236f0032933e60e6d9671d155da209d">append</a>(CodePart::APPENDEDRETURNINGREQUIRED); <span class="comment">// add a code container</span></div>
<div class="line">    part.code = <span class="stringliteral">&quot;((X*)cpu)-&gt;X_registers[1] = ((X*)cpu)-&gt;X_registers[2] + ((X*)cpu)-&gt;X_registers[3];&quot;</span>; <span class="comment">// add translated instruction to code container</span></div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">},</div>
<div class="line"> </div>
<div class="line">0, <span class="comment">// see etiss::instr::Instruction::BUILTINGROUP for possible value and meaning</span></div>
<div class="line"> </div>
<div class="line">0, <span class="comment">// callback routing to enable printing of assembler output. optional</span></div>
<div class="line"> </div>
<div class="line">);</div>
<div class="line"> </div>
<div class="line">    </div>
<div class="line">    <span class="comment">// called to add instructions to the instruction set</span></div>
<div class="line">    <span class="comment">// add      &quot;virtual void initInstrSet(etiss::instr::ModedInstructionSet &amp; ) const;&quot; to the XArch header.</span></div>
<div class="line">        <span class="keywordtype">void</span> XArch::initInstrSet(<a class="code" href="classetiss_1_1instr_1_1ModedInstructionSet.html">etiss::instr::ModedInstructionSet</a> &amp; mis)<span class="keyword"> const</span>{</div>
<div class="line">            <span class="keywordtype">bool</span> ok = <span class="keyword">true</span>;</div>
<div class="line">            CortexXX.addTo(mis,ok);</div>
<div class="line">            <span class="keywordflow">if</span> (!ok)</div>
<div class="line">                <a class="code" href="namespaceetiss.html#afd320e98bf6a5e2c0d8ffde5dd28dd35">etiss::log</a>(<a class="code" href="namespaceetiss.html#abd14e7f45415d7f9f2c7026536a6237ca8d9fd163d9fb98c7553986a7c16e02c6">etiss::FATALERROR</a>,<span class="stringliteral">&quot;Failed to add instructions for CoretxXX&quot;</span>);</div>
<div class="line">        }</div>
</div><!-- fragment --><h1><a class="anchor" id="howto_cpuarch_step4"></a>
Step 4 (only required if newTimer(ETISS_CPU * cpu) is implemented) : Implement a timer plugin</h1>
<p>It is recommended to provide a Timer plugin to enable common functionality out of the box. In this example the timer plugin class is named <b>X</b>Timer (see <a class="el" href="classetiss_1_1Plugin.html" title="base plugin class that provides access to different plugin functions if present">etiss::Plugin</a> * <b>X</b>Arch::newTimer(ETISS_CPU * cpu) of <a class="el" href="howto_cpuarch.html#howto_cpuarch_step3">Step 3</a>).</p>
<p>The additional files <b>X</b>Timer.h and <b>X</b>Timer.cpp need to be created in the ArchImpl/<b>X</b>/ folder.</p>
<p>This timer example assumes 1. that it is acceptable that the timer event only fires in between blocks (a more accurate timer would come at greater performance cost) and 2. that it needs to configure itself according to the value of X::timercfg. This results in the use of 2 plugin interface: <a class="el" href="classetiss_1_1CoroutinePlugin.html" title="this plugin will be called before a block is executed.">etiss::CoroutinePlugin</a> whose <a class="el" href="classetiss_1_1CoroutinePlugin.html#abb87e6ce4197341e52598d41244abd45" title="called before a block and may act in the same way as a block">etiss::CoroutinePlugin::execute</a> function is called in between blocks and <a class="el" href="classetiss_1_1RegisterDevicePlugin.html" title="RegisterDevicePlugin::changedRegister is called if a supported register has been changed.">etiss::RegisterDevicePlugin</a> whose eitss::RegisterDevicePlugin::changedRegister function as called upon signaled register changes</p>
<p><b>X</b>Timer.h: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="Plugin_8h.html">etiss/Plugin.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;X.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>XTimer : <span class="keyword">public</span> <a class="code" href="classetiss_1_1CoroutinePlugin.html">etiss::CoroutinePlugin</a>, <span class="keyword">public</span> <a class="code" href="classetiss_1_1RegisterDevicePlugin.html">etiss::RegisterDevicePlugin</a> {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">        XTimer();</div>
<div class="line">        <span class="keyword">virtual</span> ~XTimer();</div>
<div class="line">        <span class="keyword">virtual</span> <a class="code" href="386-GCC_8h.html#a414f0173400e449eed05f3d8cc6e72e0">etiss::int32</a> <a class="code" href="classetiss_1_1CoroutinePlugin.html#abb87e6ce4197341e52598d41244abd45">execute</a>();</div>
<div class="line">        <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classetiss_1_1RegisterDevicePlugin.html#abc375a220a4e4b11f895df3db22f59b5">changedRegister</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="timesoftfloat_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>);</div>
<div class="line"><span class="keyword">protected</span>:</div>
<div class="line">        std::string <a class="code" href="classetiss_1_1Plugin.html#a20e7dc624add4ebea9c4ec052bc2838c">_getPluginName</a>() <span class="keyword">const</span>;</div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">        <span class="keywordtype">bool</span> enabled_;</div>
<div class="line">};</div>
</div><!-- fragment --><p><b>X</b>Timer.cpp: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;XTimer.h&quot;</span></div>
<div class="line"> </div>
<div class="line">XTimer::XTimer(){</div>
<div class="line">        enabled_ = <span class="keyword">false</span>;</div>
<div class="line">}</div>
<div class="line">XTimer::~XTimer(){}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="386-GCC_8h.html#a414f0173400e449eed05f3d8cc6e72e0">etiss::int32</a> XTimer::execute(){</div>
<div class="line">        <span class="comment">//TODO</span></div>
<div class="line">        <span class="comment">// e.g.</span></div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (enabled_){ <span class="comment">//NOTE: in this simple example this check could also be performed on the cpu structure itself without the flag and the changedRegister method. In case of a more complex implementation with a modifyable timer counter register this is usually the way to go. see ArchImpl/OR1K/OR1KTimer.cpp</span></div>
<div class="line">                <span class="keywordflow">if</span> (<span class="keyword">true</span>) { <span class="comment">// check timer condition</span></div>
<div class="line">                        <span class="keywordflow">return</span> 71; <span class="comment">// return a X architecture specific timer exception code</span></div>
<div class="line">                }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="line"><span class="keywordtype">void</span> XTimer::changedRegister(<span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="timesoftfloat_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>){</div>
<div class="line">        <span class="comment">//TODO</span></div>
<div class="line">        <span class="keywordflow">if</span> (std::string(<a class="code" href="timesoftfloat_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>) == std::string(<span class="stringliteral">&quot;timerConfig&quot;</span>)){</div>
<div class="line">                enabled_ = ((X*)plugin_cpu_)-&gt;timercfg != 0; <span class="comment">// note etiss::Plugin defined the protected pointers ETISS_CPU * plugin_cpu_, ETISS_System * plugin_system_ and CPUArch * plugin_arch_ which are always valid during simulation and thus during calls to etiss::RegisterDevicePlugin::changedRegister and etiss::CoroutinePlugin::execute</span></div>
<div class="line">        }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">std::string XTimer::_getPluginName()<span class="keyword"> const</span>{</div>
<div class="line">        <span class="keywordflow">return</span> <span class="stringliteral">&quot;XTimer&quot;</span>;</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="howto_cpuarch_step5"></a>
Step 5 (only required if getGDBCore() is implemented) : Implement etiss::gdb::GDBCode to support a GDB server</h1>
<p>It is recommended to provide a <a class="el" href="classetiss_1_1plugin_1_1gdb_1_1GDBCore.html" title="provides to architecture dependent registers as defined by gdb">etiss::plugin::gdb::GDBCore</a> implementation. This minimalistic and easy to implement interface allows to use gdb to debug a simulated program.</p>
<p>The additional files <b>X</b><a class="el" href="GDBCore_8h.html">GDBCore.h</a> and <b>X</b><a class="el" href="GDBCore_8cpp.html" title="implementation of etiss/IntegratedLibrary/gdb/GDBCore.h">GDBCore.cpp</a> need to be created in ArchImpl/<b>X</b>/.</p>
<p><b>X</b><a class="el" href="GDBCore_8h.html">GDBCore.h</a>:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="GDBCore_8h.html">etiss/IntegratedLibrary/gdb/GDBCore.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>XGDBCore : <span class="keyword">public</span> <a class="code" href="classetiss_1_1plugin_1_1gdb_1_1GDBCore.html">etiss::plugin::gdb::GDBCore</a> {</div>
<div class="line">        <span class="keyword">virtual</span> std::string <a class="code" href="classetiss_1_1plugin_1_1gdb_1_1GDBCore.html#ac302dbbd9e73ef8e13f1d02aecb5c1dd">mapRegister</a>(<span class="keywordtype">unsigned</span> index);</div>
<div class="line">        <span class="keyword">virtual</span> <span class="keywordtype">unsigned</span> <a class="code" href="classetiss_1_1plugin_1_1gdb_1_1GDBCore.html#ac302dbbd9e73ef8e13f1d02aecb5c1dd">mapRegister</a>(std::string <a class="code" href="timesoftfloat_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>);</div>
<div class="line">        <span class="keyword">virtual</span> <span class="keywordtype">unsigned</span> <a class="code" href="classetiss_1_1plugin_1_1gdb_1_1GDBCore.html#ac25bd672584aee82dceb420a273ff0f5">mappedRegisterCount</a>();</div>
<div class="line">        <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classetiss_1_1plugin_1_1gdb_1_1GDBCore.html#af6d2c2e9240b8a3bfd8322e643b86f57">isLittleEndian</a>();</div>
<div class="line">};</div>
</div><!-- fragment --><p><b>X</b><a class="el" href="GDBCore_8cpp.html" title="implementation of etiss/IntegratedLibrary/gdb/GDBCore.h">GDBCore.cpp</a>:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;XGDBCore.h&quot;</span></div>
<div class="line"> </div>
<div class="line">std::string XGDBCore::mapRegister(<span class="keywordtype">unsigned</span> index){</div>
<div class="line">        <span class="comment">//TODO</span></div>
<div class="line">        <span class="keywordflow">switch</span> (index){</div>
<div class="line">        <span class="keywordflow">case</span> 0:</div>
<div class="line">                <span class="keywordflow">return</span> <span class="stringliteral">&quot;timerConfig&quot;</span>;</div>
<div class="line">        <span class="keywordflow">case</span> 1:</div>
<div class="line">                <span class="keywordflow">return</span> <span class="stringliteral">&quot;X_register1&quot;</span>;</div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">                <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">        }</div>
<div class="line">}</div>
<div class="line"><span class="keywordtype">unsigned</span> XGDBCore::mapRegister(std::string <a class="code" href="timesoftfloat_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>){</div>
<div class="line">        <span class="comment">//TODO</span></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="timesoftfloat_8c.html#a5ac083a645d964373f022d03df4849c8">name</a> == std::string(<span class="stringliteral">&quot;timerConfig&quot;</span>)){</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="timesoftfloat_8c.html#a5ac083a645d964373f022d03df4849c8">name</a> == std::string(<span class="stringliteral">&quot;X_register1&quot;</span>)){</div>
<div class="line">                <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> INVALIDMAPPING;</div>
<div class="line">}</div>
<div class="line"><span class="keywordtype">unsigned</span> XGDBCore::mappedRegisterCount(){</div>
<div class="line">        <span class="comment">//TODO</span></div>
<div class="line">        <span class="keywordflow">return</span> 2;</div>
<div class="line">}</div>
<div class="line"><span class="keywordtype">bool</span> XGDBCore::isLittleEndian(){</div>
<div class="line">        <span class="comment">//TODO</span></div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="howto_cpuarch_step6"></a>
Step 6: Implement the loading interface</h1>
<p>ETISS preferably loads a cpu architecture as a dynamic library at runtime. To do this it is necessary to implement some functions to find the CPUArch implementation(s).</p>
<p>Additional to the shown functions additional functions can be used to provide header files at runtime. Refer to <a class="el" href="doc_libraryinterface.html#doc_libraryinterface_files">The LibraryInterface file copy extension</a> for an explanation on how to store files within a library and extract them at runtime. This should be used to provide the <b>X</b>.h header file for runtime compilation. Please note that all files with the name included_c/<b>*</b> can be included during runtime compilation as #include "&lt;b&gt;*&lt;/b&gt;".</p>
<p><b>X</b>ArchLib.cpp:</p>
<div class="fragment"><div class="line"><span class="comment">// define a name for this library. this will be used to avoid name clashes with other libraries. in this example the library is named &quot;X&quot;.</span></div>
<div class="line"><span class="comment">// IMPORTANT this name MUST match the library name: e.g. X -&gt; libX.so</span></div>
<div class="line"><span class="preprocessor">#define ETISS_LIBNAME X</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="CPUArchLibrary_8h.html">etiss/helper/CPUArchLibrary.h</a>&quot;</span> <span class="comment">// defines the following functions</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;XArch.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span>{</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// implements version function</span></div>
<div class="line">        <a class="code" href="helper_2Misc_8h.html#a09184f62b97306f91bc415fa4faa3e18">ETISS_LIBRARYIF_VERSION_FUNC_IMPL</a></div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">unsigned</span> X_countCPUArch(){</div>
<div class="line">                <span class="comment">//TODO</span></div>
<div class="line">                <span class="keywordflow">return</span> 1; <span class="comment">// number of cpu architectures provided</span></div>
<div class="line">        }</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span> * X_nameCPUArch(<span class="keywordtype">unsigned</span> index){</div>
<div class="line">                <span class="comment">//TODO</span></div>
<div class="line">                <span class="keywordflow">switch</span> (index){</div>
<div class="line">                <span class="keywordflow">case</span> 0:</div>
<div class="line">                        <span class="keywordflow">return</span> <span class="stringliteral">&quot;X&quot;</span>;</div>
<div class="line">                <span class="keywordflow">default</span>:</div>
<div class="line">                        <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">                }</div>
<div class="line">        }</div>
<div class="line">        <a class="code" href="classetiss_1_1CPUArch.html">etiss::CPUArch</a>* X_createCPUArch(<span class="keywordtype">unsigned</span> index,std::map&lt;std::string,std::string&gt; <a class="code" href="CPUArchLibrary_8h.html#a6f2a44b96a2dfbf32239e40e13e1ee86">options</a>){</div>
<div class="line">                <span class="comment">//TODO</span></div>
<div class="line">                <span class="keywordflow">switch</span> (index){</div>
<div class="line">                <span class="keywordflow">case</span> 0:</div>
<div class="line">                        <span class="comment">// parse arguments?</span></div>
<div class="line">                        <span class="keywordflow">return</span> <span class="keyword">new</span> XArch();</div>
<div class="line">                <span class="keywordflow">default</span>:</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordtype">void</span> X_deleteCPUArch(<a class="code" href="classetiss_1_1CPUArch.html">etiss::CPUArch</a>* arch){</div>
<div class="line">                <span class="keyword">delete</span> arch;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="howto_cpuarch_step7"></a>
Step 7: Build and run the Library</h1>
<p>Finally a makefile or a CMakeLists.txt is needed to build the new library with the <b>X</b> architecture implementation as a dynamic library. Currently the default project CMakeLists.txt include provided by ETISS (<a class="el" href="howto_createproject.html">How to create a sub project for ETISS</a>) doesn't support stripping of symbols. Plans are to support it at later time when cmake provides better support for this.</p>
<p>Makefile:</p>
<div class="fragment"><div class="line">DEBUG?=1</div>
<div class="line"> </div>
<div class="line">CC=gcc</div>
<div class="line"> </div>
<div class="line">ifeq ($(DEBUG),0)</div>
<div class="line">        DBGPARAM =</div>
<div class="line">        OPTLEVEL?=-O3</div>
<div class="line">else</div>
<div class="line">        DBGPARAM =-g</div>
<div class="line">        OPTLEVEL?=</div>
<div class="line"><a class="code" href="include_2etiss_2fault_2xml_2CMakeLists_8txt.html#aab6517a30cc5b29252e4209e65662311">endif</a></div>
<div class="line"> </div>
<div class="line">ETISS_FOLDER=../..</div>
<div class="line"> </div>
<div class="line">CFLAGS=-std=<a class="code" href="____clang__hip__libdevice__declares_8h.html#ad55181c98da0de5b29a5afc3060fc6d0">c</a>++0<a class="code" href="namespaceetiss_1_1fault.html#ae605b1063cbd269d9010913d1f56ba21">x</a> -<a class="code" href="____clang__hip__libdevice__declares_8h.html#ad55181c98da0de5b29a5afc3060fc6d0">c</a> -MMD -Wall -Werror -fPIC $(OPTLEVEL) $(DBGPARAM) -DDEBUG=$(DEBUG) -<a class="code" href="namespaceetiss_1_1instr.html#a4b8d8e3ab5c613e688e168c06485cf65">I</a>$(ETISS_FOLDER)/include -<a class="code" href="namespaceetiss_1_1instr.html#a4b8d8e3ab5c613e688e168c06485cf65">I</a>$(ETISS_FOLDER)/include_c</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><a class="code" href="opencl-c_8h.html#aa8f04b660ce5a08a6dad7fdc20225430">all</a> : libX.so</div>
<div class="line"> </div>
<div class="line">XArch.o : XArch.cpp</div>
<div class="line">        $(CC) $(CFLAGS) XArch.cpp</div>
<div class="line"> </div>
<div class="line">XGDBCore.o : XGDBCore.cpp</div>
<div class="line">        $(CC) $(CFLAGS) XGDBCore.cpp</div>
<div class="line"> </div>
<div class="line">XTimer.o : XTimer.cpp</div>
<div class="line">        $(CC) $(CFLAGS) XTimer.cpp</div>
<div class="line"> </div>
<div class="line">XArchLib.o: XArchLib.cpp</div>
<div class="line">        $(CC) $(CFLAGS) XArchLib.cpp</div>
<div class="line"> </div>
<div class="line">-include .<span class="comment">/*.d</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">libX.so : XArch.o XGDBCore.o XTimer.o XArchLib.o</span></div>
<div class="line"><span class="comment">        $(CC) -std=c++0x -shared -g -L$(ETISS_FOLDER) -dl -o libX.so XArchLib.o XArch.o XGDBCore.o XTimer.o</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">clean :</span></div>
<div class="line"><span class="comment">        rm -f *o</span></div>
<div class="line"><span class="comment">        rm -f libX.so</span></div>
</div><!-- fragment --><p>Once the dynamic library was build it is available in ETISS by default if placed in ArchImpl/X/ or can be loaded with void <a class="el" href="group__ETISS__Frontend.html#ga0f7e980b54452e20ed605353acc02e3b" title="Load a library.">etiss::loadLibrary(std::string path,std::string name)</a>. Use <a class="el" href="group__ETISS__Frontend.html#gafdf73e148be5cda1bc5d05f01b9216c1" title="Create a set with strings of the library names and some information appended in square brackets.">etiss::listLibraries()</a> and <a class="el" href="group__ETISS__Frontend.html#gac94c0a9b460ca3d7cf4005eb80a3624c" title="Create a set with all identifier names of the known CPUArch plug-ins.">etiss::listCPUArchs()</a> to view the status of loaded libraries.</p>
<p>Refer to <a class="el" href="misc.html#misc_striplibrary">Removing symbols from a shared library</a> once the api of the new library is out of it's testing state or runtime linkage errors arise. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<div class="ttc" id="aclassetiss_1_1instr_1_1InstructionGroup_html"><div class="ttname"><a href="classetiss_1_1instr_1_1InstructionGroup.html">etiss::instr::InstructionGroup</a></div><div class="ttdoc">maps to InstructionSet</div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8h_source.html#l00931">Instruction.h:931</a></div></div>
<div class="ttc" id="aclassetiss_1_1VirtualStruct_1_1Field_html_a0c09eb9065c5126f9e16b5e86f5c24fe"><div class="ttname"><a href="classetiss_1_1VirtualStruct_1_1Field.html#a0c09eb9065c5126f9e16b5e86f5c24fe">etiss::VirtualStruct::Field::W</a></div><div class="ttdeci">static const int W</div><div class="ttdoc">write flag</div><div class="ttdef"><b>Definition:</b> <a href="VirtualStruct_8h_source.html#l00191">VirtualStruct.h:191</a></div></div>
<div class="ttc" id="aclassetiss_1_1CodeSet_html"><div class="ttname"><a href="classetiss_1_1CodeSet.html">etiss::CodeSet</a></div><div class="ttdoc">A set of CodeParts.</div><div class="ttdef"><b>Definition:</b> <a href="CodePart_8h_source.html#l00436">CodePart.h:436</a></div></div>
<div class="ttc" id="aclassetiss_1_1plugin_1_1gdb_1_1GDBCore_html_ac25bd672584aee82dceb420a273ff0f5"><div class="ttname"><a href="classetiss_1_1plugin_1_1gdb_1_1GDBCore.html#ac25bd672584aee82dceb420a273ff0f5">etiss::plugin::gdb::GDBCore::mappedRegisterCount</a></div><div class="ttdeci">virtual unsigned mappedRegisterCount()</div><div class="ttdoc">returns the number of registers in the gdb defined register list</div><div class="ttdef"><b>Definition:</b> <a href="GDBCore_8cpp_source.html#l00066">GDBCore.cpp:66</a></div></div>
<div class="ttc" id="aclassetiss_1_1CoroutinePlugin_html"><div class="ttname"><a href="classetiss_1_1CoroutinePlugin.html">etiss::CoroutinePlugin</a></div><div class="ttdoc">this plugin will be called before a block is executed.</div><div class="ttdef"><b>Definition:</b> <a href="Plugin_8h_source.html#l00298">Plugin.h:298</a></div></div>
<div class="ttc" id="ainclude_2etiss_2fault_2xml_2CMakeLists_8txt_html_aab6517a30cc5b29252e4209e65662311"><div class="ttname"><a href="include_2etiss_2fault_2xml_2CMakeLists_8txt.html#aab6517a30cc5b29252e4209e65662311">endif</a></div><div class="ttdeci">endif() endforeach() unset(LOCAL_SOURCE1) unset(LOCAL_SOURCE2) set(ETISS_HEADER $</div><div class="ttdef"><b>Definition:</b> <a href="include_2etiss_2fault_2xml_2CMakeLists_8txt_source.html#l00042">CMakeLists.txt:42</a></div></div>
<div class="ttc" id="anamespaceetiss_1_1mm_html_ae97afcab1c0c335c4b41ed82524d2ba9"><div class="ttname"><a href="namespaceetiss_1_1mm.html#ae97afcab1c0c335c4b41ed82524d2ba9">etiss::mm::NOERROR</a></div><div class="ttdeci">const MM_EXPORT int32_t NOERROR</div></div>
<div class="ttc" id="aCPUArchLibrary_8h_html_a6f2a44b96a2dfbf32239e40e13e1ee86"><div class="ttname"><a href="CPUArchLibrary_8h.html#a6f2a44b96a2dfbf32239e40e13e1ee86">options</a></div><div class="ttdeci">ETISS_PLUGIN_EXPORT etiss::CPUArch std::map&lt; std::string, std::string &gt; options</div><div class="ttdoc">create new instance of the CPUArch type at index</div><div class="ttdef"><b>Definition:</b> <a href="CPUArchLibrary_8h_source.html#l00073">CPUArchLibrary.h:73</a></div></div>
<div class="ttc" id="abuild_2include_2jit_2etiss_2jit_2types_8h_html_a72b9abbce981da044b8fce9af82f1d66"><div class="ttname"><a href="build_2include_2jit_2etiss_2jit_2types_8h.html#a72b9abbce981da044b8fce9af82f1d66">etiss_uint32</a></div><div class="ttdeci">uint32_t etiss_uint32</div><div class="ttdef"><b>Definition:</b> <a href="build_2include_2jit_2etiss_2jit_2types_8h_source.html#l00093">types.h:93</a></div></div>
<div class="ttc" id="aclassetiss_1_1CPUArch_html_ad07535d7ce770c9bf1444ba652019138"><div class="ttname"><a href="classetiss_1_1CPUArch.html#ad07535d7ce770c9bf1444ba652019138">etiss::CPUArch::getMaximumInstructionSizeInBytes</a></div><div class="ttdeci">virtual unsigned getMaximumInstructionSizeInBytes()=0</div><div class="ttdoc">used for variable instruction size and delay slots</div></div>
<div class="ttc" id="aclassetiss_1_1CPUArch_html_a09227a06379d2f2a91da6f10faa9131a"><div class="ttname"><a href="classetiss_1_1CPUArch.html#a09227a06379d2f2a91da6f10faa9131a">etiss::CPUArch::deleteCPU</a></div><div class="ttdeci">virtual void deleteCPU(ETISS_CPU *)=0</div><div class="ttdoc">delete cpu structure</div></div>
<div class="ttc" id="aCPUArch_8h_html"><div class="ttname"><a href="CPUArch_8h.html">CPUArch.h</a></div><div class="ttdoc">contains neccesary interfaces for instruction translation.</div></div>
<div class="ttc" id="aclassetiss_1_1CPUArchDefaultPlugins_html_a18f03e3f9c5003f5079fc86d1169828e"><div class="ttname"><a href="classetiss_1_1CPUArchDefaultPlugins.html#a18f03e3f9c5003f5079fc86d1169828e">etiss::CPUArchDefaultPlugins::newTimer</a></div><div class="ttdeci">virtual etiss::Plugin * newTimer(ETISS_CPU *cpu)</div><div class="ttdoc">create a simple default timer implementaion instance for this architecture.</div><div class="ttdef"><b>Definition:</b> <a href="CPUArch_8cpp_source.html#l00064">CPUArch.cpp:64</a></div></div>
<div class="ttc" id="aclassetiss_1_1CPUArch_html_a73e73070b3ea20e320166eca643bd295"><div class="ttname"><a href="classetiss_1_1CPUArch.html#a73e73070b3ea20e320166eca643bd295">etiss::CPUArch::getGDBCore</a></div><div class="ttdeci">virtual etiss::plugin::gdb::GDBCore &amp; getGDBCore()</div><div class="ttdoc">returns arch dependent gdb functions.</div><div class="ttdef"><b>Definition:</b> <a href="CPUArch_8cpp_source.html#l00138">CPUArch.cpp:138</a></div></div>
<div class="ttc" id="aclassetiss_1_1instr_1_1InstructionClass_html"><div class="ttname"><a href="classetiss_1_1instr_1_1InstructionClass.html">etiss::instr::InstructionClass</a></div><div class="ttdoc">maps to VariableInstructionSet</div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8h_source.html#l00892">Instruction.h:892</a></div></div>
<div class="ttc" id="aclassetiss_1_1CPUArch_html_a8a21733db333251915508f937b2fabf5"><div class="ttname"><a href="classetiss_1_1CPUArch.html#a8a21733db333251915508f937b2fabf5">etiss::CPUArch::createInterruptVector</a></div><div class="ttdeci">virtual etiss::InterruptVector * createInterruptVector(ETISS_CPU *cpu)</div><div class="ttdoc">allocate a new interrupt vector object for the given cpu</div><div class="ttdef"><b>Definition:</b> <a href="CPUArch_8cpp_source.html#l00128">CPUArch.cpp:128</a></div></div>
<div class="ttc" id="aclassetiss_1_1plugin_1_1gdb_1_1GDBCore_html"><div class="ttname"><a href="classetiss_1_1plugin_1_1gdb_1_1GDBCore.html">etiss::plugin::gdb::GDBCore</a></div><div class="ttdoc">provides to architecture dependent registers as defined by gdb</div><div class="ttdef"><b>Definition:</b> <a href="GDBCore_8h_source.html#l00076">GDBCore.h:76</a></div></div>
<div class="ttc" id="atimesoftfloat_8c_html_a5ac083a645d964373f022d03df4849c8"><div class="ttname"><a href="timesoftfloat_8c.html#a5ac083a645d964373f022d03df4849c8">name</a></div><div class="ttdeci">char * name</div><div class="ttdef"><b>Definition:</b> <a href="timesoftfloat_8c_source.html#l01931">timesoftfloat.c:1931</a></div></div>
<div class="ttc" id="astructETISS__CPU_html"><div class="ttname"><a href="structETISS__CPU.html">ETISS_CPU</a></div><div class="ttdoc">basic cpu state structure needed for execution of any cpu architecture.</div><div class="ttdef"><b>Definition:</b> <a href="build_2include_2jit_2etiss_2jit_2CPU_8h_source.html#l00088">CPU.h:88</a></div></div>
<div class="ttc" id="aclassetiss_1_1Plugin_html_a20e7dc624add4ebea9c4ec052bc2838c"><div class="ttname"><a href="classetiss_1_1Plugin.html#a20e7dc624add4ebea9c4ec052bc2838c">etiss::Plugin::_getPluginName</a></div><div class="ttdeci">virtual std::string _getPluginName() const =0</div></div>
<div class="ttc" id="aclassetiss_1_1CPUArch_html_af7f949bf98cf21778e678ce64c7d16a7"><div class="ttname"><a href="classetiss_1_1CPUArch.html#af7f949bf98cf21778e678ce64c7d16a7">etiss::CPUArch::handleException</a></div><div class="ttdeci">virtual etiss::int32 handleException(etiss::int32 code, ETISS_CPU *cpu)</div><div class="ttdoc">translate/process exceptions that occur at runtime</div><div class="ttdef"><b>Definition:</b> <a href="CPUArch_8cpp_source.html#l00123">CPUArch.cpp:123</a></div></div>
<div class="ttc" id="anamespaceetiss_1_1fault_html_ae605b1063cbd269d9010913d1f56ba21"><div class="ttname"><a href="namespaceetiss_1_1fault.html#ae605b1063cbd269d9010913d1f56ba21">etiss::fault::x</a></div><div class="ttdeci">int x</div><div class="ttdef"><b>Definition:</b> <a href="Injector_8cpp_source.html#l00060">Injector.cpp:60</a></div></div>
<div class="ttc" id="anamespaceetiss_html_abd14e7f45415d7f9f2c7026536a6237ca8d9fd163d9fb98c7553986a7c16e02c6"><div class="ttname"><a href="namespaceetiss.html#abd14e7f45415d7f9f2c7026536a6237ca8d9fd163d9fb98c7553986a7c16e02c6">etiss::FATALERROR</a></div><div class="ttdeci">@ FATALERROR</div><div class="ttdef"><b>Definition:</b> <a href="Misc_8h_source.html#l00126">Misc.h:126</a></div></div>
<div class="ttc" id="aPlugin_8h_html"><div class="ttname"><a href="Plugin_8h.html">Plugin.h</a></div><div class="ttdoc">plugins for extensions to code translation and instruction execution</div></div>
<div class="ttc" id="astructETISS__CPU_html_a06bc8709b023cbe50c7c594741fd47b4"><div class="ttname"><a href="structETISS__CPU.html#a06bc8709b023cbe50c7c594741fd47b4">ETISS_CPU::instructionPointer</a></div><div class="ttdeci">etiss_uint64 instructionPointer</div><div class="ttdoc">pointer to next instruction.</div><div class="ttdef"><b>Definition:</b> <a href="build_2include_2jit_2etiss_2jit_2CPU_8h_source.html#l00092">CPU.h:92</a></div></div>
<div class="ttc" id="anamespaceetiss_html"><div class="ttname"><a href="namespaceetiss.html">etiss</a></div><div class="ttdoc">Page Table Entry (PTE) defines the composition of Page Frame Number (PFN) and relavant flags.</div><div class="ttdef"><b>Definition:</b> <a href="Benchmark_8h_source.html#l00052">Benchmark.h:52</a></div></div>
<div class="ttc" id="aclassetiss_1_1MappedInterruptVector_html"><div class="ttname"><a href="classetiss_1_1MappedInterruptVector.html">etiss::MappedInterruptVector</a></div><div class="ttdoc">template implementation of an InterruptVector that uses integer variables to store interrupt bit valu...</div><div class="ttdef"><b>Definition:</b> <a href="InterruptVector_8h_source.html#l00102">InterruptVector.h:102</a></div></div>
<div class="ttc" id="aclassetiss_1_1CPUArch_html"><div class="ttname"><a href="classetiss_1_1CPUArch.html">etiss::CPUArch</a></div><div class="ttdoc">the interface to translate instructions of and processor architecture</div><div class="ttdef"><b>Definition:</b> <a href="CPUArch_8h_source.html#l00157">CPUArch.h:157</a></div></div>
<div class="ttc" id="aCPUArchLibrary_8h_html"><div class="ttname"><a href="CPUArchLibrary_8h.html">CPUArchLibrary.h</a></div><div class="ttdoc">defines the functions needed for a library that provides etiss::CPUArch implementations</div></div>
<div class="ttc" id="a386-GCC_8h_html_a414f0173400e449eed05f3d8cc6e72e0"><div class="ttname"><a href="386-GCC_8h.html#a414f0173400e449eed05f3d8cc6e72e0">int32</a></div><div class="ttdeci">etiss_int32 int32</div><div class="ttdef"><b>Definition:</b> <a href="386-GCC_8h_source.html#l00081">386-GCC.h:81</a></div></div>
<div class="ttc" id="aGDBCore_8h_html"><div class="ttname"><a href="GDBCore_8h.html">GDBCore.h</a></div></div>
<div class="ttc" id="aclassetiss_1_1CPUArch_html_a78b44720cd799cf5bc3ab664a4510140"><div class="ttname"><a href="classetiss_1_1CPUArch.html#a78b44720cd799cf5bc3ab664a4510140">etiss::CPUArch::getInstructionSizeInBytes</a></div><div class="ttdeci">virtual unsigned getInstructionSizeInBytes()=0</div><div class="ttdoc">size of one instruction/ smalest data unit for instructions of variable length</div></div>
<div class="ttc" id="aclassetiss_1_1VirtualStruct_html_a81c8fe4e603c8ab1a08e73c06e2266f5"><div class="ttname"><a href="classetiss_1_1VirtualStruct.html#a81c8fe4e603c8ab1a08e73c06e2266f5">etiss::VirtualStruct::addField</a></div><div class="ttdeci">bool addField(Field *f, bool noerrorprint=false)</div><div class="ttdef"><b>Definition:</b> <a href="VirtualStruct_8cpp_source.html#l00264">VirtualStruct.cpp:264</a></div></div>
<div class="ttc" id="aclassetiss_1_1CPUArch_html_a3b3421671e0809efe8d3b63ece28fc52"><div class="ttname"><a href="classetiss_1_1CPUArch.html#a3b3421671e0809efe8d3b63ece28fc52">etiss::CPUArch::getHeaders</a></div><div class="ttdeci">virtual const std::set&lt; std::string &gt; &amp; getHeaders() const =0</div><div class="ttdoc">set of code header files e.g.</div></div>
<div class="ttc" id="anamespaceetiss_html_afd320e98bf6a5e2c0d8ffde5dd28dd35"><div class="ttname"><a href="namespaceetiss.html#afd320e98bf6a5e2c0d8ffde5dd28dd35">etiss::log</a></div><div class="ttdeci">void log(Verbosity level, std::string msg)</div><div class="ttdoc">write log message at the given level.</div><div class="ttdef"><b>Definition:</b> <a href="Misc_8cpp_source.html#l00125">Misc.cpp:125</a></div></div>
<div class="ttc" id="aclassetiss_1_1CPUArchRegListenerInterface_html_a27b3f3b61ee0e1e70e291c73132c1efd"><div class="ttname"><a href="classetiss_1_1CPUArchRegListenerInterface.html#a27b3f3b61ee0e1e70e291c73132c1efd">etiss::CPUArchRegListenerInterface::getListenerSupportedRegisters</a></div><div class="ttdeci">virtual const std::set&lt; std::string &gt; &amp; getListenerSupportedRegisters()=0</div></div>
<div class="ttc" id="a386-GCC_8h_html_a9ef56175e2c24dae60815d7eed003bdf"><div class="ttname"><a href="386-GCC_8h.html#a9ef56175e2c24dae60815d7eed003bdf">uint32</a></div><div class="ttdeci">etiss_uint32 uint32</div><div class="ttdef"><b>Definition:</b> <a href="386-GCC_8h_source.html#l00080">386-GCC.h:80</a></div></div>
<div class="ttc" id="atcc__stdlib_2stddef_8h_html_a1be1f6f1e6c132e4c0a037ee1edd6d83"><div class="ttname"><a href="tcc__stdlib_2stddef_8h.html#a1be1f6f1e6c132e4c0a037ee1edd6d83">uint32_t</a></div><div class="ttdeci">unsigned int uint32_t</div><div class="ttdef"><b>Definition:</b> <a href="tcc__stdlib_2stddef_8h_source.html#l00023">stddef.h:23</a></div></div>
<div class="ttc" id="aclassetiss_1_1CPUArchDefaultPlugins_html_abcafc22a438cb8434876cdd9b757667c"><div class="ttname"><a href="classetiss_1_1CPUArchDefaultPlugins.html#abcafc22a438cb8434876cdd9b757667c">etiss::CPUArchDefaultPlugins::deleteTimer</a></div><div class="ttdeci">virtual void deleteTimer(etiss::Plugin *timer)</div><div class="ttdoc">delete timer instance</div><div class="ttdef"><b>Definition:</b> <a href="CPUArch_8cpp_source.html#l00069">CPUArch.cpp:69</a></div></div>
<div class="ttc" id="aclassetiss_1_1CPUArch_html_a168a3a295931bc7df7a47994c492b6c8"><div class="ttname"><a href="classetiss_1_1CPUArch.html#a168a3a295931bc7df7a47994c492b6c8">etiss::CPUArch::resetCPU</a></div><div class="ttdeci">virtual void resetCPU(ETISS_CPU *cpu, etiss::uint64 *startpointer)=0</div><div class="ttdoc">reset cpu (structure)</div></div>
<div class="ttc" id="aclassetiss_1_1CPUArch_html_a818102cdbe32c2e1aef2501170231254"><div class="ttname"><a href="classetiss_1_1CPUArch.html#a818102cdbe32c2e1aef2501170231254">etiss::CPUArch::deleteInterruptVector</a></div><div class="ttdeci">virtual void deleteInterruptVector(etiss::InterruptVector *vec, ETISS_CPU *cpu)</div><div class="ttdoc">delete an allocated interrupt vector object</div><div class="ttdef"><b>Definition:</b> <a href="CPUArch_8cpp_source.html#l00132">CPUArch.cpp:132</a></div></div>
<div class="ttc" id="aclassetiss_1_1VirtualStruct_html"><div class="ttname"><a href="classetiss_1_1VirtualStruct.html">etiss::VirtualStruct</a></div><div class="ttdoc">abstract representation of an module of a simulation which could be a embedded device of the cpu of a...</div><div class="ttdef"><b>Definition:</b> <a href="VirtualStruct_8h_source.html#l00139">VirtualStruct.h:139</a></div></div>
<div class="ttc" id="anamespaceetiss_1_1instr_html_a4b8d8e3ab5c613e688e168c06485cf65"><div class="ttname"><a href="namespaceetiss_1_1instr.html#a4b8d8e3ab5c613e688e168c06485cf65">etiss::instr::I</a></div><div class="ttdeci">uint32_t I</div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8h_source.html#l00079">Instruction.h:79</a></div></div>
<div class="ttc" id="aclassetiss_1_1RegisterDevicePlugin_html"><div class="ttname"><a href="classetiss_1_1RegisterDevicePlugin.html">etiss::RegisterDevicePlugin</a></div><div class="ttdoc">RegisterDevicePlugin::changedRegister is called if a supported register has been changed.</div><div class="ttdef"><b>Definition:</b> <a href="Plugin_8h_source.html#l00347">Plugin.h:347</a></div></div>
<div class="ttc" id="aclassetiss_1_1CodeSet_html_a7236f0032933e60e6d9671d155da209d"><div class="ttname"><a href="classetiss_1_1CodeSet.html#a7236f0032933e60e6d9671d155da209d">etiss::CodeSet::append</a></div><div class="ttdeci">void append(const CodePart &amp;part, CodePart::TYPE type)</div><div class="ttdef"><b>Definition:</b> <a href="CodePart_8h_source.html#l00450">CodePart.h:450</a></div></div>
<div class="ttc" id="aclassetiss_1_1RegisterDevicePlugin_html_abc375a220a4e4b11f895df3db22f59b5"><div class="ttname"><a href="classetiss_1_1RegisterDevicePlugin.html#abc375a220a4e4b11f895df3db22f59b5">etiss::RegisterDevicePlugin::changedRegister</a></div><div class="ttdeci">virtual void changedRegister(const char *name)=0</div><div class="ttdoc">called when an observable register has been changed</div></div>
<div class="ttc" id="aclassetiss_1_1VirtualStruct_1_1Field_html_ac49114585e171aaa911f0c9c5670cafb"><div class="ttname"><a href="classetiss_1_1VirtualStruct_1_1Field.html#ac49114585e171aaa911f0c9c5670cafb">etiss::VirtualStruct::Field::R</a></div><div class="ttdeci">static const int R</div><div class="ttdoc">read flag</div><div class="ttdef"><b>Definition:</b> <a href="VirtualStruct_8h_source.html#l00190">VirtualStruct.h:190</a></div></div>
<div class="ttc" id="anamespaceetiss_1_1instr_html_abd7ccc74d7b5d79f99f2febaf149f774"><div class="ttname"><a href="namespaceetiss_1_1instr.html#abd7ccc74d7b5d79f99f2febaf149f774">etiss::instr::parse_i32</a></div><div class="ttdeci">uint32_t parse_i32(const char *s)</div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8cpp_source.html#l01279">Instruction.cpp:1279</a></div></div>
<div class="ttc" id="atcc__stdlib_2stddef_8h_html_ab03496aa717fb9c7bee01384c245dd05"><div class="ttname"><a href="tcc__stdlib_2stddef_8h.html#ab03496aa717fb9c7bee01384c245dd05">uint64_t</a></div><div class="ttdeci">unsigned long long int uint64_t</div><div class="ttdef"><b>Definition:</b> <a href="tcc__stdlib_2stddef_8h_source.html#l00027">stddef.h:27</a></div></div>
<div class="ttc" id="aclassetiss_1_1plugin_1_1gdb_1_1GDBCore_html_af6d2c2e9240b8a3bfd8322e643b86f57"><div class="ttname"><a href="classetiss_1_1plugin_1_1gdb_1_1GDBCore.html#af6d2c2e9240b8a3bfd8322e643b86f57">etiss::plugin::gdb::GDBCore::isLittleEndian</a></div><div class="ttdeci">virtual bool isLittleEndian()</div><div class="ttdoc">returns true if the values are expected to be little endian</div><div class="ttdef"><b>Definition:</b> <a href="GDBCore_8cpp_source.html#l00070">GDBCore.cpp:70</a></div></div>
<div class="ttc" id="aclassetiss_1_1CPUArchCPUManipulation_html_a5062b8521e7c9fd4e0f6865a2fc02828"><div class="ttname"><a href="classetiss_1_1CPUArchCPUManipulation.html#a5062b8521e7c9fd4e0f6865a2fc02828">etiss::CPUArchCPUManipulation::getVirtualStruct</a></div><div class="ttdeci">virtual std::shared_ptr&lt; etiss::VirtualStruct &gt; getVirtualStruct(ETISS_CPU *cpu)=0</div><div class="ttdoc">this function must return a valid pointer to a virtual struct</div></div>
<div class="ttc" id="aclassetiss_1_1instr_1_1ModedInstructionSet_html"><div class="ttname"><a href="classetiss_1_1instr_1_1ModedInstructionSet.html">etiss::instr::ModedInstructionSet</a></div><div class="ttdoc">holds etiss::instr::VariableInstructionSet instances for different modes.</div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8h_source.html#l00814">Instruction.h:814</a></div></div>
<div class="ttc" id="aclassetiss_1_1InterruptVector_html"><div class="ttname"><a href="classetiss_1_1InterruptVector.html">etiss::InterruptVector</a></div><div class="ttdoc">interface to set interrupt bits</div><div class="ttdef"><b>Definition:</b> <a href="InterruptVector_8h_source.html#l00069">InterruptVector.h:69</a></div></div>
<div class="ttc" id="a____clang__hip__libdevice__declares_8h_html_ad55181c98da0de5b29a5afc3060fc6d0"><div class="ttname"><a href="____clang__hip__libdevice__declares_8h.html#ad55181c98da0de5b29a5afc3060fc6d0">c</a></div><div class="ttdeci">__device__ __2f16 float c</div><div class="ttdef"><b>Definition:</b> <a href="____clang__hip__libdevice__declares_8h_source.html#l00298">__clang_hip_libdevice_declares.h:298</a></div></div>
<div class="ttc" id="aclassetiss_1_1plugin_1_1gdb_1_1GDBCore_html_ac302dbbd9e73ef8e13f1d02aecb5c1dd"><div class="ttname"><a href="classetiss_1_1plugin_1_1gdb_1_1GDBCore.html#ac302dbbd9e73ef8e13f1d02aecb5c1dd">etiss::plugin::gdb::GDBCore::mapRegister</a></div><div class="ttdeci">virtual std::string mapRegister(unsigned index)</div><div class="ttdoc">the returned string identifies the register at the given index as defined by gdb.</div><div class="ttdef"><b>Definition:</b> <a href="GDBCore_8cpp_source.html#l00058">GDBCore.cpp:58</a></div></div>
<div class="ttc" id="aclassetiss_1_1Plugin_html"><div class="ttname"><a href="classetiss_1_1Plugin.html">etiss::Plugin</a></div><div class="ttdoc">base plugin class that provides access to different plugin functions if present</div><div class="ttdef"><b>Definition:</b> <a href="Plugin_8h_source.html#l00076">Plugin.h:76</a></div></div>
<div class="ttc" id="a386-GCC_8h_html_afaa37edb86065f42a0ad0a0f6c13aac2"><div class="ttname"><a href="386-GCC_8h.html#afaa37edb86065f42a0ad0a0f6c13aac2">uint64</a></div><div class="ttdeci">etiss_uint64 uint64</div><div class="ttdef"><b>Definition:</b> <a href="386-GCC_8h_source.html#l00082">386-GCC.h:82</a></div></div>
<div class="ttc" id="aclassetiss_1_1CPUArch_html_aef31da82cfd8db497138468a07879909"><div class="ttname"><a href="classetiss_1_1CPUArch.html#aef31da82cfd8db497138468a07879909">etiss::CPUArch::newCPU</a></div><div class="ttdeci">virtual ETISS_CPU * newCPU()=0</div><div class="ttdoc">allocate new cpu structure</div></div>
<div class="ttc" id="aopencl-c_8h_html_aa8f04b660ce5a08a6dad7fdc20225430"><div class="ttname"><a href="opencl-c_8h.html#aa8f04b660ce5a08a6dad7fdc20225430">all</a></div><div class="ttdeci">int __ovld __cnfn all(char x)</div><div class="ttdoc">Returns 1 if the most significant bit in all components of x is set; otherwise returns 0.</div></div>
<div class="ttc" id="aclassetiss_1_1instr_1_1InstructionCollection_html"><div class="ttname"><a href="classetiss_1_1instr_1_1InstructionCollection.html">etiss::instr::InstructionCollection</a></div><div class="ttdoc">maps to ModedInstructionSet</div><div class="ttdef"><b>Definition:</b> <a href="Instruction_8h_source.html#l00858">Instruction.h:858</a></div></div>
<div class="ttc" id="aclassetiss_1_1CoroutinePlugin_html_abb87e6ce4197341e52598d41244abd45"><div class="ttname"><a href="classetiss_1_1CoroutinePlugin.html#abb87e6ce4197341e52598d41244abd45">etiss::CoroutinePlugin::execute</a></div><div class="ttdeci">virtual etiss::int32 execute()=0</div><div class="ttdoc">called before a block and may act in the same way as a block</div></div>
<div class="ttc" id="ahelper_2Misc_8h_html_a09184f62b97306f91bc415fa4faa3e18"><div class="ttname"><a href="helper_2Misc_8h.html#a09184f62b97306f91bc415fa4faa3e18">ETISS_LIBRARYIF_VERSION_FUNC_IMPL</a></div><div class="ttdeci">#define ETISS_LIBRARYIF_VERSION_FUNC_IMPL</div><div class="ttdef"><b>Definition:</b> <a href="helper_2Misc_8h_source.html#l00085">Misc.h:85</a></div></div>
<div class="ttc" id="aclassetiss_1_1VirtualStruct_1_1Field_html"><div class="ttname"><a href="classetiss_1_1VirtualStruct_1_1Field.html">etiss::VirtualStruct::Field</a></div><div class="ttdoc">a Field instance represents e.g.</div><div class="ttdef"><b>Definition:</b> <a href="VirtualStruct_8h_source.html#l00148">VirtualStruct.h:148</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Aug 19 2022 12:53:22 for ETISS 0.8.0 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
