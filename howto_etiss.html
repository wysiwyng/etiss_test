<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ETISS 0.8.0: How to use ETISS</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ETISS 0.8.0
   </div>
   <div id="projectbrief">ExtendableTranslatingInstructionSetSimulator(version0.8.0)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">How to use ETISS </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#howto_etiss_frontendfunctions">Frontend API</a><ul><li class="level2"><a href="#howto_etiss_frontendfunctions_init">Initialize ETISS</a></li>
<li class="level2"><a href="#howto_etiss_frontendfunctions_lib">Loading libraries</a></li>
<li class="level2"><a href="#howto_etiss_frontendfunctions_cpucore">Instantiating a processor</a></li>
<li class="level2"><a href="#howto_etiss_frontendfunctions_cpucore_cfg">Configure a processor</a></li>
<li class="level2"><a href="#howto_etiss_frontendfunctions_cpucore_exec">Execute a processor</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p>For the following section ETISS and its libraries are required to be present. If this is not the case refer to <a class="el" href="index.html#install">Installation</a> to build ETISS.</p>
<h1><a class="anchor" id="howto_etiss_frontendfunctions"></a>
Frontend API</h1>
<p>ETISS provies a simple abstraction layer that allows the frontend to be very simple.</p>
<h2><a class="anchor" id="howto_etiss_frontendfunctions_init"></a>
Initialize ETISS</h2>
<p>Before the use of other functions <a class="el" href="classetiss_1_1Initializer.html" title="Wrapper for the initialize and shutdown of the ETISS environment.">etiss::Initializer</a> should be instantiated. The instantiated initializer must exist while ETISS is used (-&gt; do not use temporaries).</p>
<p>E.g.</p>
<div class="fragment"><div class="line">{<a class="code" href="main_8cpp.html#ac0f2228420376f4db7e1274f2b41667c">main</a>.cpp} </div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="main_8cpp.html#ac0f2228420376f4db7e1274f2b41667c">main</a>( <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> ** argv){</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="classetiss_1_1Initializer.html">etiss::Initializer</a> etiss_initializer(argc,argv);</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// do something with ETISS</span></div>
<div class="line"> </div>
<div class="line">}</div>
</div><!-- fragment --><p>This will fail:</p>
<div class="fragment"><div class="line">{WRONG_main.cpp} </div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="main_8cpp.html#ac0f2228420376f4db7e1274f2b41667c">main</a>( <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> ** argv){</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="classetiss_1_1Initializer.html">etiss::Initializer</a>(argc,argv);</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// do something with ETISS</span></div>
<div class="line"> </div>
<div class="line">}</div>
</div><!-- fragment --><p>Alternatively the functions <a class="el" href="group__ETISS__Frontend.html#gae0d82705849faff133052591c19f3039" title="Initialize and configure ETISS.">etiss::initialize</a> and <a class="el" href="group__ETISS__Frontend.html#gab5794090b0a2a046b4999624a20b2b1a" title="Shutdown ETISS.">etiss::shutdown</a> can be used manually.</p>
<h2><a class="anchor" id="howto_etiss_frontendfunctions_lib"></a>
Loading libraries</h2>
<p>Shared (and integrated) libraries are used to provide the actual simulation behavior. ETISS automatically loads libraries it finds in ArchImple/ * / , JITImpl/ * / and PluginImpl/ * / relative to itself and to paths in the PATH variable. A shared library can be loaded manually with <a class="el" href="group__ETISS__Frontend.html#ga0f7e980b54452e20ed605353acc02e3b" title="Load a library.">etiss::loadLibrary</a>.</p>
<h2><a class="anchor" id="howto_etiss_frontendfunctions_cpucore"></a>
Instantiating a processor</h2>
<p><a class="el" href="classetiss_1_1CPUCore.html" title="CPUCore is responsible for the simulation of a CPU core in ETISS.">etiss::CPUCore</a> represents one processor core. It can be instantiated with <a class="el" href="classetiss_1_1CPUCore.html#a804f3252302d7ae49f7918da2871f6ba" title="Create a CPUCore instance.">etiss::CPUCore::create</a> (e.g. std::shared_ptr&lt;CPUCore&gt; core0 = <a class="el" href="classetiss_1_1CPUCore.html#a804f3252302d7ae49f7918da2871f6ba" title="Create a CPUCore instance.">etiss::CPUCore::create</a>("or1k","core0")). <a class="el" href="classetiss_1_1CPUCore.html#a804f3252302d7ae49f7918da2871f6ba" title="Create a CPUCore instance.">etiss::CPUCore::create</a> takes an optional map of options that are passed to the cpu architecture instance (in this example to the architecture "or1k"). Refer to the documentation of the respective architecture implementation for a list of options (e.g. <a class="el" href="status_implementation.html#status_implementation_or1k">OR1K example implementation</a> ).</p>
<p>The <a class="el" href="classetiss_1_1CPUCore.html" title="CPUCore is responsible for the simulation of a CPU core in ETISS.">etiss::CPUCore</a> instance can already be used to execute a simulation without further configuration given that at least one library was loaded that provides a just in time compiler. If the selected cpu architecture implementation supplies a timer implementation it will be enabled by default.</p>
<h2><a class="anchor" id="howto_etiss_frontendfunctions_cpucore_cfg"></a>
Configure a processor</h2>
<p>To specify which just in time compiler should be used <a class="el" href="classetiss_1_1CPUCore.html#a9d8a67fbed9ba6fa5dd9d82835581ff3" title="Set the JIT plug-in used for execution.">etiss::CPUCore::set(std::shared_ptr&lt;etiss::JIT&gt; jit)</a> can be called. <a class="el" href="classetiss_1_1JIT.html" title="compiler interface for just in time compilation of generated C code">etiss::JIT</a> instances can be acquired with <a class="el" href="group__ETISS__Frontend.html#gaa5e8c6d44d5e6b27cb4384e60c557283" title="Get a present JIT plug-in by name.">etiss::getJIT()</a>. Available <a class="el" href="classetiss_1_1JIT.html" title="compiler interface for just in time compilation of generated C code">etiss::JIT</a> implementations can be listed with <a class="el" href="group__ETISS__Frontend.html#ga75f9ca679a5b798343d7954156aa19c0" title="Create a set with all identifier names of the known JIT plug-ins.">etiss::listJITs()</a>.</p>
<p>Usage of the default timer can be enabled/disabled with <a class="el" href="classetiss_1_1CPUCore.html#af429e196584c0b9973c7f5e4d97e3a4d" title="Enable or disable the timer of the CPU.">etiss::CPUCore::setTimer</a>.</p>
<p>Use <a class="el" href="classetiss_1_1CPUCore.html#a97bd4fd5ed1a74d4c24c0d18cc0077ed" title="Adds a plug-in to the core simulator.">etiss::CPUCore::addPlugin</a> to add plugins. Plugin instances may not be shared between <a class="el" href="classetiss_1_1CPUCore.html" title="CPUCore is responsible for the simulation of a CPU core in ETISS.">etiss::CPUCore</a> instances. For a list of integrated plugins refer to <a class="el" href="status_implementation.html#status_implementation_integratedlibrary">ETISS's Integrated Library</a></p>
<p>If interrupts are supported and should be used then the Interrupt vector wrapper <a class="el" href="classetiss_1_1InterruptVector.html" title="interface to set interrupt bits">etiss::InterruptVector</a> returned by <a class="el" href="classetiss_1_1CPUCore.html#af738c399b5acae82397436f931e3c804" title="Get the interrupt vector of simulated CPU.">etiss::CPUCore::getInterruptVector()</a> can be used. Since time synchronization between ETISS and the rest of a simulation only happens periodically an <a class="el" href="classetiss_1_1InterruptHandler.html" title="class that handles interrupt signaling and checking.">etiss::InterruptHandler</a> should be used to ensure deterministic behavior even in threaded simulations. If the systemC wrapper class (SystemCBridge defined in systemc/SystemCBridge.h) is used then that wrapper will handle the InterruptVector with the help of InterruptHandler and provides simple sc_core::sc_in&lt;bool&gt; ports to use for interrupt lines.</p>
<h2><a class="anchor" id="howto_etiss_frontendfunctions_cpucore_exec"></a>
Execute a processor</h2>
<p>To start the simulation of a <a class="el" href="classetiss_1_1CPUCore.html" title="CPUCore is responsible for the simulation of a CPU core in ETISS.">etiss::CPUCore</a> instance call <a class="el" href="classetiss_1_1CPUCore.html#a3abad91e823939228f7db1596e040c19" title="Start the simulation of the CPU core for the system model.">etiss::CPUCore::execute</a>. A <a class="el" href="structETISS__System.html" title="memory access and time synchronization functions.">ETISS_System</a> or <a class="el" href="classetiss_1_1System.html" title="System Interface for the basic system IO operations and time synchronization.">etiss::System</a> implementation needs to be passed to this function. A <a class="el" href="structETISS__System.html" title="memory access and time synchronization functions.">ETISS_System</a> implementation is preferred since <a class="el" href="classetiss_1_1System.html" title="System Interface for the basic system IO operations and time synchronization.">etiss::System</a> needs to be wrapped in a <a class="el" href="structETISS__System.html" title="memory access and time synchronization functions.">ETISS_System</a> structure thus adding an additional function call per access. The System handles instruction/data reads/writes and synchronizes times. For a simple example implementation refer to <a class="el" href="classetiss_1_1SimpleMemSystem.html" title="simple etiss:System implementation for testing">etiss::SimpleMemSystem</a>.</p>
<p>Alternatively a systemC wrapper class called SystemCBridge (defined in systemc/SystemCBridge.h) can handle ETISSs interrupt and system interface internally and provides two tlm sockets for instruction/data read/writes and sc_core::sc_in&lt;bool&gt; ports for interrupt and reset lines. Please note that this wrapper most likely will let your simulation run a bit longer than specified to allow <a class="el" href="classetiss_1_1CPUCore.html#a3abad91e823939228f7db1596e040c19" title="Start the simulation of the CPU core for the system model.">etiss::CPUCore::execute</a> to exit cleanly and delete shared pointers. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<div class="ttc" id="amain_8cpp_html_ac0f2228420376f4db7e1274f2b41667c"><div class="ttname"><a href="main_8cpp.html#ac0f2228420376f4db7e1274f2b41667c">main</a></div><div class="ttdeci">int main(int argc, const char *argv[])</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00048">main.cpp:48</a></div></div>
<div class="ttc" id="aclassetiss_1_1Initializer_html"><div class="ttname"><a href="classetiss_1_1Initializer.html">etiss::Initializer</a></div><div class="ttdoc">Wrapper for the initialize and shutdown of the ETISS environment.</div><div class="ttdef"><b>Definition:</b> <a href="ETISS_8h_source.html#l00253">ETISS.h:253</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Aug 19 2022 12:53:22 for ETISS 0.8.0 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
